(function(){var e={9969:function(e,t,a){"use strict";var i=a(6369),l=a(8499),r=a.n(l),s=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("Home"),t("div",{staticClass:"content"},[t("div",{staticClass:"Nav"},[t("Navigation")],1),t("div",{staticClass:"View"},[e.isRouterAlive?t("router-view"):e._e()],1)])],1)},o=[],n=function(){var e=this;e._self._c;return e._m(0)},c=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"B-header"},[t("div",{staticClass:"header-left"},[t("div",{staticClass:"h1"},[e._v("ETC交通感知大数据平台")]),t("div",{staticClass:"h5"},[e._v(" ETC traffic perception big data platform 蜂格式交通感知、风险分析与应急管理平台 ")])]),t("div",{staticClass:"header-right"},[t("div",{staticClass:"h2 padding"},[e._v("深圳信息职业技术学院区块链应用技术创新中心")]),t("div",{staticClass:"h2"},[e._v("广东省教育厅车路协同数据安全关键技术及拓展应用研发产教融合创新平台")])])])}],h={name:"Home"},d=h,m=a(1001),u=(0,m.Z)(d,n,c,!1,null,"d7937d76",null),p=u.exports,g=function(){var e=this,t=e._self._c;return t("div",{staticClass:"nav-content"},[t("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.isActivePath,router:!0}},[t("el-menu-item",{staticClass:"pad",attrs:{index:"/RegMana"}},[t("i",{staticClass:"el-icon-location"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("区域管理")])]),t("el-menu-item",{staticClass:"pad",attrs:{index:"/SiteMana"}},[t("i",{staticClass:"el-icon-location"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("站点管理")])]),t("el-submenu",{staticClass:"pad",attrs:{index:"/DeviceMana"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-s-platform"}),t("span",[e._v("设备管理")])]),t("el-menu-item-group",[t("el-menu-item",{attrs:{index:"/DeviceMana"}},[e._v("设备列表")]),t("el-menu-item",{attrs:{index:"DeviceTypeMana"}},[e._v("设备类型")])],1)],2),t("el-submenu",{staticClass:"pad",attrs:{index:"/CarInfoRecord"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-upload"}),t("span",[e._v("车辆信息")])]),t("el-menu-item-group",[t("el-menu-item",{attrs:{index:"/CarInfoRecord"}},[e._v("列表展示")]),t("el-menu-item",{attrs:{index:"/vehicleMap"}},[e._v("地图展示")])],1)],2),t("el-menu-item",{staticClass:"pad",attrs:{index:"/DeviceBeatMana"}},[t("i",{staticClass:"el-icon-upload"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("设备心跳")])])],1)],1)},v=[],b={name:"Navigation",data(){return{isActive:1,isActivePath:""}},created(){this.activePath()},methods:{activePath(){this.isActivePath=this.$router.history.current.path}}},f=b,y=(0,m.Z)(f,g,v,!1,null,null,null),k=y.exports,w=a(6265),D=a.n(w);function F(e){const t=D().create({baseURL:"http://139.199.220.137:7039/",timeout:5e3});return t.interceptors.request.use((e=>(console.log("res",e),e)),(e=>(console.log("err",e.request.data),e.request.data))),t.interceptors.response.use((e=>e.data),(e=>e.response.data)),t(e)}function S(e,t){return F({url:"/regional/selectAll",method:"get",params:{currentPage:e,pageSize:t}})}function C(e){return F({url:"/regional/add",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})}function M(e){return F({url:`/regional/${e}`,method:"delete"})}function N(e){return F({url:"/regional/update",method:"put",data:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function x(e){return F({url:"/regional/getSiteName",method:"get",params:{id:e}})}function A(e,t){return F({url:"/site/selectAll",method:"get",params:{currentPage:e,pageSize:t}})}function _(e){return F({url:"/site/add",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})}function R(e){return F({url:`/site/${e}`,method:"delete"})}function P(e){return F({url:"/site/update",method:"put",data:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function T(e){return F({url:"/site/selectCondition",method:"get",params:e})}function z(e,t){return F({url:"/device/selectAll",method:"get",params:{currentPage:e,pageSize:t}})}function O(e){return F({url:"/device/add",method:"post",params:e})}function L(e){return F({url:`/device/${e}`,method:"delete"})}function I(e){return F({url:"/device/update",method:"put",params:e})}function $(e){return F({url:"/device/selectCondition",method:"get",params:e})}function V(e){return F({url:"/heartBeat/state",method:"post",params:{devId:e}})}function j(e,t){return F({url:"/type/selectAll",method:"get",params:{currentPage:e,pageSize:t}})}function q(e){return F({url:"/type/add",method:"post",params:e})}function B(e){return F({url:`/type/${e}`,method:"delete"})}function J(e){return F({url:"/type/update",method:"put",params:e})}function E(){return F({url:"/vehicle/selectAll",method:"get",params:{currentPage:"1",pageSize:"10"}})}function Z(e,t){return F({url:"/vehicle/selectAll",method:"get",params:{currentPage:e,pageSize:t}})}function H(e){return F({url:"/vehicle/add",method:"post",params:e})}function Q(e){return console.log("obj",e),F({url:"/vehicle/selectCondition",method:"get",params:e})}function U(e){return F({url:"/vehicle/judge",method:"post",params:e})}const W=(0,i.reactive)({defaultProps:{children:"children",label:"label"},search:"",siteMap:null,vehicleMap:null,Marker:null,gps:[],pageNum:"1",pageSize:"100",regionTotalCount:0,siteTotalCount:0,regionData:[],regionAllData:[],drawPolygonPath:[],siteData:[],siteAllData:[],vehicleData:[],vehicleAllData:[],deviceAllData:[],deviceTypeData:[],deviceTypeAllData:[],getRegAllData(){S(this.pageNum,this.pageSize).then((e=>{this.regionAllData=e.data.rows,this.getToArray(this.regionAllData),console.log("321",e.data.rows)})).catch((e=>{console.log(e)}))},getToArray(e){for(let t=0;t<e.length;t++){let a=JSON.parse(e[t].area);e[t].area=a}},getSiteAllDataList(){A(this.pageNum,this.pageSize).then((e=>{this.siteAllData.splice(0),this.siteAllData=e.data.rows,this.getToSiteArray()})).catch((e=>{console.log(e)}))},getToSiteArray(){for(let e=0;e<this.siteAllData.length;e++){let t=JSON.parse(this.siteAllData[e].siteRange);this.siteAllData[e].siteRange=t}},getDeviceTypeData(){j(this.pageNum,this.pageSize).then((e=>{this.deviceTypeAllData=e.data.rows})).catch((e=>{console.log(e)}))},UpDevData(){z(this.pageNum,this.pageSize).then((e=>{this.deviceAllData=e.data.rows})).catch((e=>{console.log(e)}))},getAllVehicleData(){Z(this.pageNum,this.pageSize).then((e=>{this.vehicleAllData=e.data.rows})).catch((e=>{console.log(e)}))}});var G={name:"App",components:{Home:p,Navigation:k},provide(){return{reload:this.reload}},data(){return{store:W,isRouterAlive:!0}},created(){this.store.getRegAllData(),this.store.getSiteAllDataList(),this.store.getDeviceTypeData(),this.store.UpDevData(),this.store.getAllVehicleData()},methods:{reload(){this.isRouterAlive=!1,this.$nextTick((function(){this.isRouterAlive=!0}))}}},X=G,K=(0,m.Z)(X,s,o,!1,null,null,null),Y=K.exports,ee=a(2631),te=function(){var e=this,t=e._self._c;return t("div",{staticClass:"reg-body"},[t("div",{staticClass:"reg-body-total"},[t("div",{staticClass:"reg-body-item-select"},[t("el-select",{staticStyle:{"margin-right":"10px"},attrs:{clearable:"",placeholder:"请选择区域",disabled:e.select},on:{clear:e.emptySelect},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}},e._l(this.store.regionAllData,(function(a,i){return t("el-option",{key:a.id,attrs:{label:a.name,value:a.id},nativeOn:{click:function(t){return e.showRegional(i,a.id)}}})})),1),1===e.allOrPart?t("el-select",{staticStyle:{"margin-right":"10px"},attrs:{placeholder:"请选择站点",disabled:e.select},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},e._l(this.store.siteAllData,(function(a,i){return t("el-option",{key:i,attrs:{label:a.siteName,value:a.siteName},nativeOn:{click:function(t){return e.showMarker(a.siteName)}}})})),1):t("el-select",{staticStyle:{"margin-right":"10px"},attrs:{placeholder:"请选择站点",disabled:e.select},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},e._l(this.sitePartData,(function(a,i){return t("el-option",{key:i,attrs:{label:a.siteName,value:a.siteName},nativeOn:{click:function(t){return e.showMarker(a.siteName)}}})})),1)],1),t("div",{staticClass:"Rebody-item-click"},[t("div",{staticClass:"Rebody-item-button"},[t("el-button",{attrs:{type:"primary",disabled:e.select},on:{click:e.addRegion}},[e._v("添加区域")])],1),t("div",{staticClass:"Rebody-item-button"},[t("el-button",{attrs:{type:"success"},on:{click:e.clickRegManaList}},[e._v("列表视图")])],1),t("div",{staticClass:"Rebody-item-button"},[t("el-button",{attrs:{type:"success"},on:{click:e.clickMap}},[e._v("Map视图")])],1)])]),t("div",{staticClass:"routerStyle"},[t("router-view",{ref:"child"})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showDraw,expression:"showDraw"}],staticClass:"draw"},[t("div",{staticClass:"word"},[e._v(" 点击左键开始绘制，按右键结束 ")]),t("el-row",[t("el-button",{staticStyle:{"margin-bottom":"7px"},attrs:{size:"medium",type:"primary"},on:{click:e.cancelDraw}},[e._v("取消")]),t("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.submitDrawPath}},[e._v("完成绘制")])],1)],1),t("el-dialog",{attrs:{title:"添加区域信息",visible:e.dialogAddRegVisible},on:{"update:visible":function(t){e.dialogAddRegVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.addRegForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"区域名称"}},[t("el-input",{model:{value:e.addRegForm.name,callback:function(t){e.$set(e.addRegForm,"name",t)},expression:"addRegForm.name"}})],1),t("el-form-item",{attrs:{label:"风险等级"}},[t("el-select",{attrs:{placeholder:"请选择风险等级"},model:{value:e.addRegForm.riskLevel,callback:function(t){e.$set(e.addRegForm,"riskLevel",t)},expression:"addRegForm.riskLevel"}},e._l(e.riskLevelOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"管控等级"}},[t("el-select",{attrs:{placeholder:"请选择管控等级"},model:{value:e.addRegForm.controlLevel,callback:function(t){e.$set(e.addRegForm,"controlLevel",t)},expression:"addRegForm.controlLevel"}},e._l(e.controlLevelOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"备注"}},[t("el-input",{model:{value:e.addRegForm.remarks,callback:function(t){e.$set(e.addRegForm,"remarks",t)},expression:"addRegForm.remarks"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.addRegionToServe}},[e._v("保存")]),t("el-button",{on:{click:function(t){e.dialogAddRegVisible=!1}}},[e._v("取消")])],1)],1)],1)],1)},ae=[],ie=function(){var e=this,t=e._self._c;return t("div",[t("div",{attrs:{id:"map"}}),t("div",{staticClass:"item"},[t("h4",[e._v("左击获取经纬度：")]),t("div",{staticClass:"input-item"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.gps,expression:"gps"}],attrs:{type:"text",readonly:"true"},domProps:{value:e.gps},on:{input:function(t){t.target.composing||(e.gps=t.target.value)}}})])]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showChangeDraw,expression:"showChangeDraw"}],staticClass:"change-draw"},[t("el-row",[t("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.cancelChangeDraw}},[e._v("取消")]),t("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){return e.polyEditor.open()}}},[e._v("开始修改")]),t("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.enterChange}},[e._v("完成修改")])],1)],1),t("el-dialog",{attrs:{title:"修改区域信息",visible:e.dialogRegVisible},on:{"update:visible":function(t){e.dialogRegVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.RegForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"区域序号"}},[t("el-input",{attrs:{disabled:""},model:{value:e.RegForm.id,callback:function(t){e.$set(e.RegForm,"id",t)},expression:"RegForm.id"}})],1),t("el-form-item",{attrs:{label:"区域名称"}},[t("el-input",{model:{value:e.RegForm.name,callback:function(t){e.$set(e.RegForm,"name",t)},expression:"RegForm.name"}})],1),t("el-form-item",{attrs:{label:"风险等级"}},[t("el-select",{attrs:{placeholder:"请选择风险等级"},model:{value:e.RegForm.riskLevel,callback:function(t){e.$set(e.RegForm,"riskLevel",t)},expression:"RegForm.riskLevel"}},e._l(e.riskLevelOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"管控等级"}},[t("el-select",{attrs:{placeholder:"请选择管控等级"},model:{value:e.RegForm.controlLevel,callback:function(t){e.$set(e.RegForm,"controlLevel",t)},expression:"RegForm.controlLevel"}},e._l(e.controlLevelOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"备注"}},[t("el-input",{model:{value:e.RegForm.remarks,callback:function(t){e.$set(e.RegForm,"remarks",t)},expression:"RegForm.remarks"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.submitRegData}},[e._v("保存")]),t("el-button",{on:{click:e.cancelChangeForm}},[e._v("取消")])],1)],1)],1)],1)},le=[],re=a(7634),se=a.n(re),oe=(new i["default"],a(5410)),ne=a.n(oe),ce={name:"Map",inject:["reload"],data(){return{store:W,gps:"",newMap:"",siteIdT:"",nameList:[],RegForm:{},polygon:{},polyEditor:{},dialogRegVisible:!1,showChangeDraw:!1,riskLevelOptions:[{value:"无风险",label:"无风险"},{value:"低风险",label:"低风险"},{value:"中风险",label:"中风险"},{value:"高风险",label:"高风险"}],controlLevelOptions:[{value:"无",label:"无"},{value:"防范",label:"防范"},{value:"管控",label:"管控"},{value:"封控",label:"封控"}],polygonList:[{},{},{}],markerList:[[],[],[]],drawPolygonPath:[]}},mounted(){this.initMap()},methods:{initMap(){se().load({key:"e0182f82d3a2e2470ca386ea85595acc",version:"2.0",plugins:["AMap.AutoComplete","AMap.ElasticMarker","AMap.TileLayer","AMap.PlaceSearch","AMap.Scale","AMap.MarkerCluster","AMap.OverView","AMap.ToolBar","AMap.MouseTool","AMap.MapType","AMap.Driving","AMap.DragRoute","AMap.PolygonEditor","AMap.CircleEditor","AMap.ControlBar"]}).then((e=>{this.newMap=new e.Map("map",{resizeEnable:!0,zoom:15,viewMode:"3D",center:[114.215448,22.684815]}),this.newMap.on("click",(e=>{this.gps=e.lnglat.lng+","+e.lnglat.lat,console.log(this.gps)})),this.createDefaultPolygon(),console.log("6610"),this.addAllPolygonToMap(),this.addMarker(),this.$route.query.id>=0&&(console.log("45615"),this.showChangeDraw=!0,console.log("45615"),this.changeDraw(this.$route.query.id));new e.InfoWindow({offset:new e.Pixel(0,-30)})})).catch((e=>{console.log(e)}))},testFunc(){let e=new Array;e[0]=new Array,e[0][0]=1,console.log(e)},createDefaultPolygon(){this.polygonList.splice(0),this.store.getRegAllData();for(let e=0;e<this.store.regionAllData.length;e++)switch(this.store.regionAllData[e].riskLevel){case"无风险":this.polygonList[e]=new AMap.Polygon({path:this.store.regionAllData[e].area,fillColor:"#7FFFD4",strokeOpacity:1,fillOpacity:.7,strokeColor:"#7FFFD4",strokeWeight:2,strokeStyle:"solid",strokeDasharray:[5,5]});break;case"低风险":this.polygonList[e]=new AMap.Polygon({path:this.store.regionAllData[e].area,fillColor:"#00BFFF",strokeOpacity:1,fillOpacity:.7,strokeColor:"#00BFFF",strokeWeight:2,strokeStyle:"solid",strokeDasharray:[5,5]});break;case"中风险":this.polygonList[e]=new AMap.Polygon({path:this.store.regionAllData[e].area,fillColor:"#FFD700",strokeOpacity:1,fillOpacity:.7,strokeColor:"#FFD700",strokeWeight:2,strokeStyle:"solid",strokeDasharray:[5,5]});break;case"高风险":this.polygonList[e]=new AMap.Polygon({path:this.store.regionAllData[e].area,fillColor:"#FF0000",strokeOpacity:1,fillOpacity:.7,strokeColor:"#FF0000",strokeWeight:2,strokeStyle:"solid",strokeDasharray:[5,5]});break;default:this.polygonList[e]=new AMap.Polygon({path:this.store.regionAllData[e].area,fillColor:"#7FFFD4",strokeOpacity:1,fillOpacity:.7,strokeColor:"#7FFFD4",strokeWeight:3,strokeStyle:"solid",strokeDasharray:[5,5]})}},addPolygonToMap(e,t){this.newMap.remove(this.polygonList),this.newMap.add(this.polygonList[e]),this.newMap.setCenter(this.store.regionAllData[e].area[0]);let a=Number(this.store.regionAllData[e].zoom);this.newMap.setZoom(a)},addAllPolygonToMap(){this.newMap.remove(this.polygonList),this.newMap.add(this.polygonList),console.log(this.polygonList.length)},drawPolygon(){let e=new AMap.MouseTool(this.newMap);return e.polygon({strokeColor:"#FF33FF",strokeOpacity:1,strokeWeight:6,strokeOpacity:.2,fillColor:"#1791fc",fillOpacity:.4,strokeStyle:"solid"}),this.drawPolygonPath.splice(0),e.on("draw",(e=>{let t=this.newMap.getZoom();this.$parent.addRegForm.zoom=Math.floor(t);let a=JSON.stringify(e.obj._opts.path),i='{"area":"'+a+'"}';this.$parent.addRegForm.area=i})),this.drawPolygonPath},changeDraw(e,t){let a=[],i=1,l=Number(e);for(let s=0;s<this.store.regionData.length;s++)l===this.store.regionData[s].id&&(a=this.store.regionData[s].area,i=s);console.log("c",a),this.polygon=new AMap.Polygon({path:a,strokeColor:"#FF33FF",strokeWeight:6,strokeOpacity:.2,fillOpacity:.4,fillColor:"#1791fc",zIndex:50,bubble:!0}),this.newMap.add(this.polygon),this.newMap.setCenter(this.store.regionData[i].area[0]);let r=Number(this.store.regionData[i].zoom);return this.newMap.setZoom(r),this.drawPolygonPath.splice(0),this.searchForChange(l),this.polyEditor=new AMap.PolygonEditor(this.newMap,this.polygon),this.drawPolygonPath},enterChange(){this.polyEditor.close();let e=JSON.stringify(this.polygon._opts.path),t='{"area":"'+e+'"}';this.RegForm.area=t;let a=this.newMap.getZoom();this.RegForm.zoom=Math.floor(a),console.log(this.RegForm),console.log(this.RegForm.zoom),this.showChangeDraw=!1,this.dialogRegVisible=!0},searchForChange(e){for(let t=0;t<this.store.regionData.length;t++)if(e===this.store.regionData[t].id){let e=JSON.parse(JSON.stringify(this.store.regionData[t]));this.RegForm=e}},submitRegData(e){let t=ne().stringify(this.RegForm);N(t).then((e=>{console.log("zl1",e),this.reload()})).catch((e=>{console.log(e)})),this.dialogRegVisible=!1,this.showChangeDraw=!1,this.$router.push("/RegMana/RegManaList")},cancelChangeDraw(){this.showChangeDraw=!1,this.reload(),this.$router.push("/RegMana/RegManaList")},addMarker(){for(let e=0;e<this.store.siteAllData.length;e++)this.markerList[e]=new Array,this.markerList[e][0]=this.store.siteAllData[e].siteName,this.markerList[e][1]=new AMap.Marker({position:this.store.siteAllData[e].siteRange,offset:new AMap.Pixel(-13,-30),label:{direction:"right",offset:new AMap.Pixel(10,0),content:this.store.siteAllData[e].siteName}});this.addAllMarkerToMap()},addAllMarkerToMap(e){for(let t=0;t<this.markerList.length;t++)this.markerList[t][1].setMap(this.newMap)},addMarkerToMap(e){console.log(e);let t=0;this.newMap.remove(this.markerList),this.markerList.map(((a,i)=>{a[0]===e&&(this.newMap.add(a[1]),t=i)})),this.newMap.setCenter(this.store.siteAllData[t].siteRange)},askServe(){this.store.getAllVehicleData();let e=+new Date,t=this.store.vehicleAllData.length,a=this.store.vehicleAllData[t-1],i=a.startTime,l=+new Date(i);console.log("seq",typeof a.siteId),e-l<=6e5&&(this.siteIdT=a.siteId,this.store.siteAllData.map(((e,t)=>{e.siteId,id})))},cancelChangeForm(){this.dialogChangeVisible=!1,this.$router.push("/RegMana/RegManaList")}}},he=ce,de=(0,m.Z)(he,ie,le,!1,null,"1d3597de",null),me=de.exports,ue=function(){var e=this,t=e._self._c;return t("div",{staticClass:"RegManaList"},[t("div",{staticClass:"table"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:this.store.regionData,"max-height":"600",border:""}},[t("el-table-column",{attrs:{align:"center",prop:"id",label:"区域序号","min-width":"100"}}),t("el-table-column",{attrs:{align:"center",prop:"name",label:"区域名称","min-width":"100"}}),t("el-table-column",{attrs:{align:"center",prop:"",label:"GPS",width:"200",type:"expand"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"gps-list"},[t("ul",e._l(a.row.area,(function(a){return t("li",[e._v(e._s(" 范围点："+a))])})),0)])]}}])}),t("el-table-column",{attrs:{align:"center",prop:"riskLevel",label:"风险等级","min-width":"100"}}),t("el-table-column",{attrs:{align:"center",prop:"controlLevel",label:"管控等级","min-width":"100"}}),t("el-table-column",{attrs:{align:"center",prop:"remarks",label:"备注","min-width":"180"}}),t("el-table-column",{attrs:{align:"center",label:"操作","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"medium",type:"warning"},on:{click:function(t){return e.editRegData(a.row.id)}}},[e._v("修改区域")]),t("el-button",{attrs:{size:"medium",type:"danger"},on:{click:function(t){return e.deleteRegData(a.row.id)}}},[e._v("删除区域")])]}}])})],1),t("el-pagination",{staticStyle:{"text-align":"center"},attrs:{layout:"total, sizes, prev, pager, next, jumper",total:e.regionTotalCount},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1)])},pe=[],ge={name:"RegManaList",inject:["reload"],data(){return{store:W,zoom:12,area:[],RegData:[],gpsList:[],regionTotalCount:0,pageNum:"1",pageSize:"10",isTrue:!0}},created(){this.getRegData()},methods:{getRegData(){S(this.pageNum,this.pageSize).then((e=>{this.store.regionData=e.data.rows,this.regionTotalCount=e.data.totalCount,this.getToArray(this.store.regionData)})).catch((e=>{console.log(e)}))},getToArray(e){for(let t=0;t<e.length;t++){let a=JSON.parse(e[t].area);e[t].area=a}},currentChange(e){this.pageNum=e,S(this.pageNum,this.pageSize).then((e=>{this.store.regionData=e.data.rows,this.getToArray(this.store.regionData)})).catch((e=>{console.log(e)}))},sizeChange(e){this.pageSize=e,S(this.pageNum,this.pageSize).then((e=>{this.store.regionData=e.data.rows,this.getToArray(this.store.regionData)})).catch((e=>{console.log(e)}))},editRegData(e){this.$router.push({path:"/RegMana/Map",query:{id:e}})},deleteRegData(e){M(e).then((e=>{console.log("delete",e),this.reload()})).catch((e=>{console.log("delete",e)}))}}},ve=ge,be=(0,m.Z)(ve,ue,pe,!1,null,"6c672e87",null),fe=be.exports,ye={name:"RegionalMana",inject:["reload"],components:{Map:me,RegManaList:fe},data(){return{store:W,select:!1,allOrPart:1,value1:"",value2:"",value3:"",pageNum:"1",pageSize:"10",showDraw:!1,regionData:[],siteAllData:[],sitePartData:[],pageName:"区域管理",dialogAddRegVisible:!1,riskLevelOptions:[{value:"无风险",label:"无风险"},{value:"低风险",label:"低风险"},{value:"中风险",label:"中风险"},{value:"高风险",label:"高风险"}],controlLevelOptions:[{value:"无",label:"无"},{value:"防范",label:"防范"},{value:"管控",label:"管控"},{value:"封控",label:"封控"}],addRegForm:{name:"",area:[],riskLevel:"",controlLevel:"",remarks:"",zoom:15}}},mounted(){this.decideSelect(),this.store.getSiteAllDataList()},methods:{clickMap(){this.$router.push("/RegMana/Map"),window.location.reload(),this.select=!1},clickRegManaList(){this.$router.push("/RegMana/RegManaList"),this.select=!0},decideSelect(){"/RegMana/RegManaList"===this.$router.history.current.path&&(this.select=!0)},getToArray(){for(let e=0;e<this.store.regionData.length;e++){let t=JSON.parse(this.store.regionData[e].area);this.store.regionData[e].area=t}},addRegion(){this.showDraw=!0,this.addRegForm.area=this.$refs.child.drawPolygon()},submitDrawPath(){this.showDraw=!1,this.dialogAddRegVisible=!0},addRegionToServe(){C(this.addRegForm).then((e=>{console.log(e),this.$refs.child.createDefaultPolygon(),this.$refs.child.addAllPolygonToMap(),this.dialogAddRegVisible=!1})).catch((e=>{console.log(e),alert("错误："+e.code)}))},showRegional(e,t){let a=Number(e);x(t).then((e=>{this.sitePartData=e.data,this.allOrPart=2})).catch((e=>{console.log(e)})),this.$refs.child.addPolygonToMap(a)},showMarker(e){this.$refs.child.addMarkerToMap(e)},cancelDraw(){this.reload()},emptySelect(){this.allOrPart=1,this.$refs.child.addAllPolygonToMap()}}},ke=ye,we=(0,m.Z)(ke,te,ae,!1,null,"8fca2182",null),De=we.exports,Fe=function(){var e=this,t=e._self._c;return t("div",{staticClass:"SiteBody"},[t("div",{staticClass:"site-item"},[t("div",{staticClass:"site-item-line"},[t("div",{staticClass:"site-item-line-path"},[e._v(" "+e._s(e.PageName)+" ")]),t("div",{staticClass:"site-item-line-button"},[t("div",{staticClass:"site-item-line-button-input"},[t("el-select",{staticClass:"adjustment",staticStyle:{width:"150px"},attrs:{clearable:"",placeholder:"请选择区域"},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}},e._l(this.store.regionAllData,(function(e,a){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})})),1),t("el-input",{staticClass:"input-style",attrs:{clearable:"",size:"medium",placeholder:"请输入站点名称"},model:{value:e.searchForm.siteName,callback:function(t){e.$set(e.searchForm,"siteName",t)},expression:"searchForm.siteName"}}),t("el-input",{staticClass:"input-style",attrs:{clearable:"",size:"medium",placeholder:"请输入站点编号"},model:{value:e.searchForm.siteNumber,callback:function(t){e.$set(e.searchForm,"siteNumber",t)},expression:"searchForm.siteNumber"}}),t("el-button",{staticClass:"add-margin",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.getQuery}},[e._v("搜索")]),t("el-button",{staticStyle:{width:"80px"},attrs:{type:"info"},on:{click:function(t){return e.clearSearch()}}},[e._v("重置")])],1),t("el-button",{attrs:{type:"primary"},on:{click:e.clickAddSite}},[e._v("添加站点")])],1)]),t("div",{staticClass:"site-item-table"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:0===e.getOrSearch?this.store.siteData:e.siteSearchData}},[t("el-table-column",{attrs:{align:"center",label:"站点编号","min-width":"100",prop:"siteNumber"}}),t("el-table-column",{attrs:{align:"center",label:"站点名称","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",[e._v(e._s(a.row.siteName))])]}}])}),t("el-table-column",{attrs:{align:"center",label:"站点GPS","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",[e._v(e._s(a.row.siteRange[0])+","+e._s(a.row.siteRange[1]))])]}}])}),t("el-table-column",{attrs:{align:"center",label:"所属区域","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",[e._v(e._s(a.row.name))])]}}])}),t("el-table-column",{attrs:{align:"center",label:"备注","min-width":"100",prop:"remarks"}}),t("el-table-column",{attrs:{fixed:"right",width:"200",align:"right"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("el-input",{attrs:{size:"medium",clearable:"",placeholder:"请输入关键字"},on:{clear:e.getSiteDataList,input:e.getSearch},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"medium",type:"warning"},on:{click:function(t){return e.editSiteData(a.row.siteId)}}},[e._v("修改")]),e._v("    "),t("el-button",{attrs:{size:"medium",type:"danger"},on:{click:function(t){return e.deleteSite(a.row.siteId)}}},[e._v("删除")])]}}])})],1),t("el-pagination",{staticStyle:{"text-align":"center"},attrs:{layout:"total, sizes, prev, pager, next, jumper","current-page":e.currentPage,total:e.totalCount},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"size-change":e.sizeChange,"current-change":e.currentChange}})],1)]),t("el-dialog",{attrs:{title:"添加站点",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",rules:e.rules}},[t("el-form-item",{attrs:{label:"区域id",prop:"rgId"}},[t("el-select",{attrs:{placeholder:"请选择区域"},model:{value:e.form.rgId,callback:function(t){e.$set(e.form,"rgId",t)},expression:"form.rgId"}},e._l(e.store.regionAllData,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"站点编号",prop:"siteNumber"}},[t("el-input",{model:{value:e.form.siteNumber,callback:function(t){e.$set(e.form,"siteNumber",t)},expression:"form.siteNumber"}})],1),t("el-form-item",{attrs:{label:"站点名称",prop:"siteName"}},[t("el-input",{model:{value:e.form.siteName,callback:function(t){e.$set(e.form,"siteName",t)},expression:"form.siteName"}})],1),t("el-form-item",{attrs:{label:"备注"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addSite()}}},[e._v("立即创建")]),t("el-button",{on:{click:e.cancelChange}},[e._v("取消")])],1)],1)],1),t("el-dialog",{attrs:{title:"修改站点信息",visible:e.dialogChangeVisible},on:{"update:visible":function(t){e.dialogChangeVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.SiteForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"站点编号"}},[t("el-input",{model:{value:e.SiteForm.siteNumber,callback:function(t){e.$set(e.SiteForm,"siteNumber",t)},expression:"SiteForm.siteNumber"}})],1),t("el-form-item",{attrs:{label:"站点名称"}},[t("el-input",{model:{value:e.SiteForm.siteName,callback:function(t){e.$set(e.SiteForm,"siteName",t)},expression:"SiteForm.siteName"}})],1),t("el-form-item",{attrs:{label:"站点GPS"}},[t("el-input",{attrs:{disabled:""},model:{value:e.SiteForm.siteRange,callback:function(t){e.$set(e.SiteForm,"siteRange",t)},expression:"SiteForm.siteRange"}})],1),t("el-form-item",{attrs:{label:"所属区域"}},[t("el-input",{model:{value:e.SiteForm.name,callback:function(t){e.$set(e.SiteForm,"name",t)},expression:"SiteForm.name"}})],1),t("el-form-item",{attrs:{label:"备注"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.SiteForm.remarks,callback:function(t){e.$set(e.SiteForm,"remarks",t)},expression:"SiteForm.remarks"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitSiteData()}}},[e._v("保存")]),t("el-button",{on:{click:function(t){e.dialogChangeVisible=!1}}},[e._v("取消")])],1)],1)],1)],1)},Se=[],Ce={name:"SiteMana",inject:["reload"],data(){return{store:W,search:"",getOrSearch:0,siteSearchData:[],currentPage:1,pageNum:"1",pageSize:"10",totalCount:0,number1:null,number2:null,PageName:"站点管理",SiteForm:{},SiteData:[],dialogFormVisible:!1,dialogChangeVisible:!1,searchForm:{currentPage:1,pageSize:10,name:"",siteName:"",siteNumber:""},rules:{rgId:[{required:!0,message:"请选择活动区域",trigger:"change"}],siteNumber:[{required:!0,message:"请输入站点编号",trigger:"blur"}],siteName:[{required:!0,message:"请输入站点名称",trigger:"blur"}]},form:{name:"",siteName:"",siteNumber:"",siteRange:[],rgId:"",remarks:""},defaultProps:{children:"children",label:"label"}}},mounted(){if("返回站点列表"===this.$route.params.order&&(console.log("gps1",this.store.gps),console.log(this.$route.params.order),this.openAddForm()),this.$route.params.siteID>=0){let e=Number(this.$route.params.siteID);this.openChangeForm(e)}},created(){this.getSiteDataList()},methods:{testSite(){console.log(this.SiteForm)},getSiteDataList(){A(this.pageNum,this.pageSize).then((e=>{console.log("res1",e.data.rows),this.store.siteData.splice(0),this.store.siteData=e.data.rows,this.totalCount=e.data.totalCount,this.getOrSearch=0,this.getToArray(this.store.siteData)})).catch((e=>{console.log(e)}))},getToArray(e){for(let t=0;t<e.length;t++){let a=JSON.parse(e[t].siteRange);e[t].siteRange=a}},currentChange(e){0===this.getOrSearch?(this.pageNum=e,A(this.pageNum,this.pageSize).then((e=>{this.store.siteData.splice(0),this.store.siteData=e.data.rows,console.log(e.data.rows),this.getToArray(this.store.siteData)})).catch((e=>{console.log(e)}))):(this.searchForm.currentPage=e,this.getQuery())},sizeChange(e){0===this.getOrSearch?(this.pageSize=e,this.searchForm.pageSize=e,A(this.pageNum,this.pageSize).then((e=>{console.log("res ",e.data),this.store.siteData.splice(0),this.store.siteData=e.data.rows,this.getToArray(this.store.siteData)})).catch((e=>{console.log(e)}))):(this.searchForm.pageSize=e,this.getQuery())},clickAddSite(){this.$router.push({path:"/siteMap",query:{order:"添加站点"}})},openAddForm(){this.dialogFormVisible=!0},addSite(){this.form.siteRange=this.store.gps,console.log("siteRange",this.form.siteRange),this.form.siteRange=JSON.stringify(this.form.siteRange),_(this.form).then((e=>{console.log(e),window.location.reload()})).catch((e=>{console.log(e)})),this.dialogFormVisible=!1},editSiteData(e){console.log("st",e),console.log(typeof e),this.$router.push({path:"/siteMap",query:{siteId:e}})},openChangeForm(e){this.dialogChangeVisible=!0;for(let t=0;t<this.store.siteData.length;t++)if(e===this.store.siteData[t].siteId){const e=JSON.parse(JSON.stringify(this.store.siteData[t]));this.SiteForm=e,console.log(this.SiteForm)}},submitSiteData(){this.SiteForm.siteRange=JSON.stringify(this.SiteForm.siteRange);let e=ne().stringify(this.SiteForm);P(e).then((e=>{console.log(e),window.location.reload()})).catch((e=>{console.log(e)})),this.dialogChangeVisible=!1},deleteSite(e){R(e).then((e=>{console.log("res",e),this.reload()})).catch((e=>{console.log("err",e)}))},getSearch(){let e=this.search.toLowerCase(),t=[];""===e&&this.getSiteDataList(),t=this.store.siteData.filter((t=>-1!==t.siteNumber.toLowerCase().indexOf(e)||-1!==t.siteName.toLowerCase().indexOf(e)||-1!==t.name.toLowerCase().indexOf(e)?t:void 0)),this.totalCount=t.length,this.store.siteData=t},getQuery(){0===this.getOrSearch&&(this.currentPage=1),T(this.searchForm).then((e=>{this.siteSearchData=e.data.rows,this.totalCount=e.data.totalCount,this.getToArray(this.siteSearchData),this.getOrSearch=1})).catch((e=>{console.log(e)}))},clearSearch(){this.getSiteDataList(),this.reload()},cancelChange(){this.dialogFormVisible=!1,window.location.reload()}}},Me=Ce,Ne=(0,m.Z)(Me,Fe,Se,!1,null,"7e3f5072",null),xe=Ne.exports,Ae=function(){var e=this,t=e._self._c;return t("div",{staticClass:"DevBody"},[t("div",{staticClass:"dev-item"},[t("div",{staticClass:"dev-item-line"},[t("div",{staticClass:"dev-item-line-path"},[e._v(e._s(e.PageName))]),t("div",{staticClass:"dev-item-line-button"},[t("div",{staticClass:"dev-item-line-button-input"},[t("el-input",{staticClass:"input-style",attrs:{clearable:"",size:"medium",placeholder:"请输入设备编号"},model:{value:e.searchForm.devNumber,callback:function(t){e.$set(e.searchForm,"devNumber",t)},expression:"searchForm.devNumber"}}),t("el-input",{staticClass:"input-style",attrs:{clearable:"",size:"medium",placeholder:"请输入设备名称"},model:{value:e.searchForm.devName,callback:function(t){e.$set(e.searchForm,"devName",t)},expression:"searchForm.devName"}}),t("el-select",{staticClass:"adjustment",staticStyle:{width:"150px"},attrs:{clearable:"",placeholder:"请选择站点"},model:{value:e.searchForm.siteName,callback:function(t){e.$set(e.searchForm,"siteName",t)},expression:"searchForm.siteName"}},e._l(this.store.siteAllData,(function(e){return t("el-option",{key:e.siteId,attrs:{label:e.siteName,value:e.siteName}})})),1),t("el-select",{staticClass:"adjustment",staticStyle:{width:"165px"},attrs:{clearable:"",placeholder:"请选择设备类型"},model:{value:e.searchForm.typeName,callback:function(t){e.$set(e.searchForm,"typeName",t)},expression:"searchForm.typeName"}},e._l(this.store.deviceTypeAllData,(function(e){return t("el-option",{key:e.id,attrs:{label:e.typeName,value:e.typeName}})})),1),t("el-button",{staticClass:"add-margin",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.getQuery}},[e._v("搜索")]),t("el-button",{staticStyle:{width:"80px"},attrs:{type:"info"},on:{click:e.clearSearch}},[e._v("重置")])],1),t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添加设备")])],1)]),t("div",{staticClass:"dev-item-table"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:0===e.getOrSearch?e.deviceData:e.deviceSearchData}},[t("el-table-column",{attrs:{align:"center",fixed:"",label:"设备编号","min-width":"100",prop:"devNumber"}}),t("el-table-column",{attrs:{align:"center",label:"设备名称","min-width":"100",prop:"devName"}}),t("el-table-column",{attrs:{align:"center",label:"所属站点","min-width":"150",prop:"siteName"}}),t("el-table-column",{attrs:{align:"center",label:"IP地址","min-width":"120",prop:"ip"}}),t("el-table-column",{attrs:{align:"center",label:"MAC地址","min-width":"160",prop:"mac"}}),t("el-table-column",{attrs:{align:"center",label:"设备类型","min-width":"100",prop:"typeName"}}),t("el-table-column",{attrs:{align:"center",label:"设备状态","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[1===a.row.state?t("div",[t("el-tag",{attrs:{size:"small"}},[e._v("在线")])],1):t("div",[t("el-tag",{attrs:{type:"danger",size:"small"}},[e._v("离线")])],1)]}}])}),t("el-table-column",{attrs:{align:"center",label:"备注","min-width":"100",prop:"remarks"}}),t("el-table-column",{attrs:{fixed:"right",width:"170",align:"right"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("el-input",{attrs:{size:"medium",clearable:"",placeholder:"请输入关键字"},on:{clear:e.UpDevData,input:e.getSearch},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"medium",type:"warning"},on:{click:function(t){return e.editDevData(a.row.devNumber)}}},[e._v("修改")]),t("el-button",{attrs:{size:"medium",type:"danger"},on:{click:function(t){return e.deleteDevDate(a.row.devId)}}},[e._v("删除")])]}}])})],1),t("el-pagination",{staticStyle:{"text-align":"center"},attrs:{layout:"total, sizes, prev, pager, next, jumper","current-page":e.currentPage,total:e.totalCount},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"size-change":e.sizeChange,"current-change":e.currentChange}})],1)]),t("el-dialog",{attrs:{title:"添加设备",visible:e.dialogFormVisible,width:"40%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"站点ID"}},[t("el-select",{attrs:{placeholder:"请选择站点"},model:{value:e.form.siteId,callback:function(t){e.$set(e.form,"siteId",t)},expression:"form.siteId"}},e._l(e.store.siteAllData,(function(e){return t("el-option",{key:e.siteId,attrs:{label:e.siteName,value:e.siteId}})})),1)],1),t("el-form-item",{attrs:{label:"设备编号",prop:"devNumber"}},[t("el-input",{staticStyle:{width:"300px"},model:{value:e.form.devNumber,callback:function(t){e.$set(e.form,"devNumber",t)},expression:"form.devNumber"}})],1),t("el-form-item",{attrs:{label:"设备名称",prop:"devName"}},[t("el-input",{staticStyle:{width:"300px"},model:{value:e.form.devName,callback:function(t){e.$set(e.form,"devName",t)},expression:"form.devName"}})],1),t("el-form-item",{attrs:{label:"设备IP"}},[t("el-input",{staticStyle:{width:"300px"},model:{value:e.form.ip,callback:function(t){e.$set(e.form,"ip",t)},expression:"form.ip"}})],1),t("el-form-item",{attrs:{label:"设备MAC",prop:"mac"}},[t("el-input",{staticStyle:{width:"300px"},model:{value:e.form.mac,callback:function(t){e.$set(e.form,"mac",t)},expression:"form.mac"}})],1),t("el-form-item",{attrs:{label:"设备类型(Id)",prop:"typeId"}},[t("el-select",{attrs:{placeholder:"请选择站点"},model:{value:e.form.typeId,callback:function(t){e.$set(e.form,"typeId",t)},expression:"form.typeId"}},e._l(e.store.deviceTypeAllData,(function(e){return t("el-option",{key:e.id,attrs:{label:e.typeName,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"备注"}},[t("el-input",{staticStyle:{width:"300px"},attrs:{type:"textarea"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addDev()}}},[e._v("添加")]),t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")])],1)],1)],1),t("el-dialog",{attrs:{title:"修改设备信息",visible:e.dialogChangeDevFormVisible},on:{"update:visible":function(t){e.dialogChangeDevFormVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.devForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"设备编号"}},[t("el-input",{model:{value:e.devForm.devNumber,callback:function(t){e.$set(e.devForm,"devNumber",t)},expression:"devForm.devNumber"}})],1),t("el-form-item",{attrs:{label:"设备名称"}},[t("el-input",{model:{value:e.devForm.devName,callback:function(t){e.$set(e.devForm,"devName",t)},expression:"devForm.devName"}})],1),t("el-form-item",{attrs:{label:"所属站点"}},[t("el-input",{model:{value:e.devForm.siteName,callback:function(t){e.$set(e.devForm,"siteName",t)},expression:"devForm.siteName"}})],1),t("el-form-item",{attrs:{label:"IP地址"}},[t("el-input",{model:{value:e.devForm.ip,callback:function(t){e.$set(e.devForm,"ip",t)},expression:"devForm.ip"}})],1),t("el-form-item",{attrs:{label:"MAC地址"}},[t("el-input",{model:{value:e.devForm.mac,callback:function(t){e.$set(e.devForm,"mac",t)},expression:"devForm.mac"}})],1),t("el-form-item",{attrs:{label:"设备类型"}},[t("el-input",{model:{value:e.devForm.typeName,callback:function(t){e.$set(e.devForm,"typeName",t)},expression:"devForm.typeName"}})],1),t("el-form-item",{attrs:{label:"备注"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.devForm.remarks,callback:function(t){e.$set(e.devForm,"remarks",t)},expression:"devForm.remarks"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitDevData()}}},[e._v("保存")]),t("el-button",{on:{click:e.cancelChange}},[e._v("取消")])],1)],1)],1)],1)},_e=[];function Re(e,t){return F({url:"/heartBeat/selectAll",method:"get",params:{currentPage:e,pageSize:t}})}function Pe(e){return F({url:"/heartBeat/selectDevId",method:"get",params:e})}function Te(){return F({url:"/heartBeat/state",method:"post"})}var ze={name:"DeviceMana",inject:["reload"],data(){return{store:W,search:"",getOrSearch:0,currentPage:1,state:"在",intervalOn:null,pageNum:"1",pageSize:"10",totalCount:0,devForm:{},deviceData:[],deviceSearchData:[],PageName:"设备管理",dialogFormVisible:!1,dialogChangeDevFormVisible:!1,defaultProps:{children:"children",label:"label"},searchForm:{currentPage:1,pageSize:10,devNumber:"",devName:"",siteName:"",typeName:""},form:{siteId:"",devNumber:"",devName:"",ip:"",mac:"",typeId:"",remarks:""}}},created(){this.UpDevData(),this.lunXun()},methods:{UpDevData(){z(this.pageNum,this.pageSize).then((e=>{console.log(e.data.rows),this.deviceData=e.data.rows,this.totalCount=e.data.totalCount,this.getOrSearch=0})).catch((e=>{console.log(e)}))},currentChange(e){0===this.getOrSearch?(this.pageNum=e,z(this.pageNum,this.pageSize).then((e=>{this.deviceData=e.data.rows})).catch((e=>{console.log(e)}))):(this.searchForm.currentPage=e,this.getQuery())},sizeChange(e){0===this.getOrSearch?(this.pageSize=e,this.searchForm.pageSize=e,z(this.pageNum,this.pageSize).then((e=>{this.deviceData=e.data.rows})).catch((e=>{console.log(e)}))):(this.searchForm.pageSize=e,this.getQuery())},addDev(){O(this.form).then((e=>{this.reload()})).catch((e=>{console.log(e),alert("错误："+e.code)})),this.dialogFormVisible=!1},editDevData(e){this.dialogChangeDevFormVisible=!0,this.deviceData.map((t=>{if(e===t.devNumber){const e=JSON.parse(JSON.stringify(t));this.devForm=e}}))},submitDevData(){I(this.devForm).then((e=>{this.reload()})).catch((e=>{console.log(e)})),this.dialogChangeDevFormVisible=!1},cancelChange(){this.dialogChangeDevFormVisible=!1},deleteDevDate(e){L(e).then((e=>{this.reload()})).catch((e=>{console.log("err",e)}))},getSearch(){window.clearInterval(this.intervalOn);let e=this.search.toLowerCase(),t=[];""===e&&this.UpDevData(),t=this.deviceData.filter((t=>-1!==t.devNumber.toLowerCase().indexOf(e)||-1!==t.devName.toLowerCase().indexOf(e)||-1!==t.siteName.toLowerCase().indexOf(e)||-1!==t.typeName.toLowerCase().indexOf(e)?t:void 0)),this.totalCount=t.length,this.deviceData=t},getQuery(){window.clearInterval(this.intervalOn),0===this.getOrSearch&&(this.currentPage=1),$(this.searchForm).then((e=>{this.deviceSearchData=e.data.rows,this.totalCount=e.data.totalCount,this.getOrSearch=1})).catch((e=>{console.log(e)}))},queryState(e){e=Number(e),console.log(e),e=2,V(e).then((e=>{console.log(e),this.UpDevData()})).catch((e=>{console.log(e)}))},clearSearch(){this.intervalOn=window.setInterval((()=>{this.askServe()}),5e3),this.UpDevData(),this.reload()},askServe(){Te().then((e=>{console.log(e),this.UpDevData()})).catch((e=>{console.log(e)}))},lunXun(){this.intervalOn=window.setInterval((()=>{this.askServe()}),5e3)}}},Oe=ze,Le=(0,m.Z)(Oe,Ae,_e,!1,null,"fc095530",null),Ie=Le.exports,$e=function(){var e=this,t=e._self._c;return t("div",{staticClass:"type-body"},[t("div",{staticClass:"type-line"},[t("div",{staticClass:"type-line-path"},[e._v(e._s(e.PageName))]),t("div",{staticClass:"type-line-button"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添加设备类型")])],1)]),t("div",{staticClass:"type-table"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:this.store.deviceTypeData}},[t("el-table-column",{attrs:{align:"center",fixed:"",label:"设备类型id","min-width":"100",prop:"id"}}),t("el-table-column",{attrs:{align:"center",label:"设备类型","min-width":"100",prop:"typeName"}}),t("el-table-column",{attrs:{fixed:"right",width:"200",align:"right"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("el-input",{attrs:{size:"medium",clearable:"",placeholder:"请输入关键字"},on:{clear:e.getDeviceTypeData,input:e.getSearch},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"medium",type:"warning"},on:{click:function(t){return e.editDevTypeData(a.row.id)}}},[e._v("修改")]),t("el-button",{attrs:{size:"medium",type:"danger"},on:{click:function(t){return e.deleteDevTypeDate(a.row.id)}}},[e._v("删除")])]}}])})],1),t("el-pagination",{staticStyle:{"text-align":"center"},attrs:{layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"current-change":e.currentChange}}),t("el-dialog",{attrs:{title:"添加设备类型",visible:e.dialogFormVisible,width:"40%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"类型编号",prop:"devNumber"}},[t("el-input",{staticStyle:{width:"300px"},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1),t("el-form-item",{attrs:{label:"类型名称",prop:"devName"}},[t("el-input",{staticStyle:{width:"300px"},model:{value:e.form.typeName,callback:function(t){e.$set(e.form,"typeName",t)},expression:"form.typeName"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addDevType()}}},[e._v("添加")]),t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")])],1)],1)],1),t("el-dialog",{attrs:{title:"修改设备类型信息",visible:e.dialogChangeDevFormVisible},on:{"update:visible":function(t){e.dialogChangeDevFormVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.devTypeForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"类型id"}},[t("el-input",{model:{value:e.devTypeForm.id,callback:function(t){e.$set(e.devTypeForm,"id",t)},expression:"devTypeForm.id"}})],1),t("el-form-item",{attrs:{label:"设备类型"}},[t("el-input",{model:{value:e.devTypeForm.typeName,callback:function(t){e.$set(e.devTypeForm,"typeName",t)},expression:"devTypeForm.typeName"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitDevTypeData()}}},[e._v("保存")]),t("el-button",{on:{click:e.cancelChange}},[e._v("取消")])],1)],1)],1)],1)])},Ve=[],je={name:"DeviceTypeMana",inject:["reload"],data(){return{store:W,devTypeForm:{},PageName:"设备类型",search:"",pageNum:"1",pageSize:"10",totalCount:0,dialogFormVisible:!1,dialogChangeDevFormVisible:!1,form:{id:"",typeName:""}}},created(){this.getDeviceTypeData()},methods:{getDeviceTypeData(){j(this.pageNum,this.pageSize).then((e=>{this.store.deviceTypeData=e.data.rows,this.totalCount=e.data.totalCount})).catch((e=>{console.log(e)}))},currentChange(e){this.pageNum=e,j(this.pageNum,this.pageSize).then((e=>{this.store.deviceTypeData=e.data.rows})).catch((e=>{console.log(e)}))},sizeChange(e){this.pageSize=e,j(this.pageNum,this.pageSize).then((e=>{this.store.deviceTypeData=e.data.rows})).catch((e=>{console.log(e)}))},addDevType(){q(this.form).then((e=>{console.log(e),this.reload()})).catch((e=>{console.log(e),alert("错误："+e.code)})),this.dialogFormVisible=!1},editDevTypeData(e){this.dialogChangeDevFormVisible=!0,this.store.deviceTypeData.map((t=>{if(e===t.id){const e=JSON.parse(JSON.stringify(t));this.devTypeForm=e}}))},submitDevTypeData(){J(this.devTypeForm).then((e=>{console.log(e),this.reload()})).catch((e=>{console.log(e)})),this.dialogChangeDevFormVisible=!1},cancelChange(){console.log("123"),this.dialogChangeDevFormVisible=!1,console.log("456")},deleteDevTypeDate(e){B(e).then((e=>{this.reload()})).catch((e=>{console.log("err",e)}))},getSearch(){let e=this.search.toLowerCase(),t=[];""===e&&this.getDeviceTypeData(),t=this.store.deviceTypeData.filter((t=>{if(-1!==t.typeName.toLowerCase().indexOf(e))return t})),this.totalCount=t.length,this.store.deviceTypeData=t}}},qe=je,Be=(0,m.Z)(qe,$e,Ve,!1,null,"feb4490e",null),Je=Be.exports,Ee=function(){var e=this,t=e._self._c;return t("div",{staticClass:"vehicle-body"},[t("div",{staticClass:"vehicle-line"},[t("div",{staticClass:"vehicle-page"},[e._v(e._s(e.PageName))]),t("div",{staticClass:"vehicle-button"},[t("div",{staticClass:"vehicle-button-input"},[t("el-input",{staticClass:"input-style",attrs:{size:"medium",placeholder:"请输入车牌号"},model:{value:e.searchForm.licensePlate,callback:function(t){e.$set(e.searchForm,"licensePlate",t)},expression:"searchForm.licensePlate"}}),t("el-input",{staticClass:"input-style",attrs:{size:"medium",placeholder:"请输入OBU ID"},model:{value:e.searchForm.obuId,callback:function(t){e.$set(e.searchForm,"obuId",t)},expression:"searchForm.obuId"}}),t("el-select",{staticStyle:{width:"150px","margin-top":"4px"},attrs:{clearable:"",placeholder:"请选择站点"},model:{value:e.searchForm.siteName,callback:function(t){e.$set(e.searchForm,"siteName",t)},expression:"searchForm.siteName"}},e._l(this.store.siteAllData,(function(e){return t("el-option",{key:e.siteId,attrs:{label:e.siteName,value:e.siteName}})})),1),t("el-date-picker",{staticClass:"input-style",attrs:{type:"datetime",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",placeholder:"选择日期时间"},model:{value:e.searchForm.startTime,callback:function(t){e.$set(e.searchForm,"startTime",t)},expression:"searchForm.startTime"}}),e._v(" - "),t("el-date-picker",{staticClass:"input-style",attrs:{type:"datetime",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",placeholder:"选择日期时间"},model:{value:e.searchForm.endTime,callback:function(t){e.$set(e.searchForm,"endTime",t)},expression:"searchForm.endTime"}}),t("el-button",{staticClass:"add-margin",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.getQuery}},[e._v("搜索")]),t("el-button",{staticStyle:{width:"80px"},attrs:{type:"info"},on:{click:e.clearSearch}},[e._v("重置")])],1),t("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(t){e.dialogAddVehicleVisible=!0}}},[e._v("添加车辆")])],1)]),t("div",{staticClass:"vehicle-list"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:0===e.getOrSearch?e.vehicleData:e.vehicleSearchData}},[t("el-table-column",{attrs:{align:"center",label:"序号",width:"100",prop:"virId",sortable:""}}),t("el-table-column",{attrs:{align:"center",label:"车牌",width:"200",prop:"licensePlate",sortable:""}}),t("el-table-column",{attrs:{align:"center",label:"OBU ID","min-width":"200",prop:"obuId",sortable:""}}),t("el-table-column",{attrs:{align:"center",label:"开始时间","min-width":"200",prop:"startTime",sortable:""}}),t("el-table-column",{attrs:{align:"center",label:"结束时间","min-width":"200",prop:"endTime",sortable:""}}),t("el-table-column",{attrs:{align:"center",label:"识别次数",width:"150",prop:"frequency"}}),t("el-table-column",{attrs:{align:"center",label:"所属区域",width:"150",prop:"regionalName"}}),t("el-table-column",{attrs:{align:"center",label:"体温",width:"100",prop:"wendu"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.showThermodynamicDiagram(a.row.wendu)}}},[e._v(e._s(a.row.wendu))])]}}])}),t("el-table-column",{attrs:{align:"center",label:"风险等级",width:"150",prop:"riskLevel"}}),t("el-table-column",{attrs:{align:"center",label:"管控等级",width:"150",prop:"controlLevel"}}),t("el-table-column",{attrs:{align:"center",label:"识别站点",width:"150",prop:"siteName",sortable:""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"site",on:{click:function(t){return e.getSite(a.row.siteId)}}},[e._v(e._s(a.row.siteName))])]}}])})],1),t("el-pagination",{staticStyle:{"text-align":"center"},attrs:{total:e.totalCount,"current-page":e.currentPage,"page-sizes":[10,15,20,50,100],layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.sizeChange,"current-change":e.currentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}},model:{value:e.limit,callback:function(t){e.limit=t},expression:"limit"}})],1),t("el-dialog",{attrs:{title:"提示",visible:e.dialogAddVehicleVisible,width:"40%"},on:{"update:visible":function(t){e.dialogAddVehicleVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.vehicleForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"车牌号"}},[t("el-input",{staticStyle:{width:"300px"},model:{value:e.vehicleForm.licensePlate,callback:function(t){e.$set(e.vehicleForm,"licensePlate",t)},expression:"vehicleForm.licensePlate"}})],1),t("el-form-item",{attrs:{label:"OBU ID"}},[t("el-input",{staticStyle:{width:"300px"},model:{value:e.vehicleForm.obuId,callback:function(t){e.$set(e.vehicleForm,"obuId",t)},expression:"vehicleForm.obuId"}})],1),t("el-form-item",{attrs:{label:"开始时间"}},[t("el-col",{attrs:{span:11}},[t("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:e.date1,callback:function(t){e.date1=t},expression:"date1"}})],1)],1),t("el-form-item",{attrs:{label:"结束时间"}},[t("el-col",{attrs:{span:11}},[t("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:e.date3,callback:function(t){e.date3=t},expression:"date3"}})],1)],1),t("el-form-item",{attrs:{label:"识别次数"}},[t("el-input",{staticStyle:{width:"300px"},model:{value:e.vehicleForm.frequency,callback:function(t){e.$set(e.vehicleForm,"frequency",t)},expression:"vehicleForm.frequency"}})],1),t("el-form-item",{attrs:{label:"区域名称"}},[t("el-select",{attrs:{placeholder:"请选择区域"},model:{value:e.vehicleForm.regionalName,callback:function(t){e.$set(e.vehicleForm,"regionalName",t)},expression:"vehicleForm.regionalName"}},e._l(e.store.regionAllData,(function(a,i){return t("el-option",{key:a.id,attrs:{label:a.name,value:a.name},nativeOn:{click:function(t){return e.showSite(a.name,a.riskLevel,a.controlLevel)}}})})),1)],1),t("el-form-item",{attrs:{label:"站点ID"}},[t("el-select",{attrs:{placeholder:"请选择站点"},model:{value:e.vehicleForm.siteId,callback:function(t){e.$set(e.vehicleForm,"siteId",t)},expression:"vehicleForm.siteId"}},e._l(e.showSiteForm,(function(e){return t("el-option",{key:e.siteId,attrs:{label:e.siteName,value:e.siteId}})})),1)],1),t("el-form-item",{attrs:{label:"风险等级"}},[t("el-input",{staticStyle:{width:"300px"},model:{value:e.vehicleForm.riskLevel,callback:function(t){e.$set(e.vehicleForm,"riskLevel",t)},expression:"vehicleForm.riskLevel"}})],1),t("el-form-item",{attrs:{label:"管控等级"}},[t("el-input",{staticStyle:{width:"300px"},model:{value:e.vehicleForm.controlLevel,callback:function(t){e.$set(e.vehicleForm,"controlLevel",t)},expression:"vehicleForm.controlLevel"}})],1),t("el-form-item",{attrs:{label:"识别设备"}},[t("el-select",{attrs:{placeholder:"请选择设备"},model:{value:e.vehicleForm.devId,callback:function(t){e.$set(e.vehicleForm,"devId",t)},expression:"vehicleForm.devId"}},e._l(e.store.deviceAllData,(function(e){return t("el-option",{key:e.devId,attrs:{label:e.devName,value:e.devId}})})),1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addVehicle()}}},[e._v("立即创建")]),t("el-button",{on:{click:function(t){e.dialogAddVehicleVisible=!1}}},[e._v("取消")])],1)],1)],1),t("el-dialog",{attrs:{title:"",visible:e.dialogSiteVisible,width:"40%"},on:{"update:visible":function(t){e.dialogSiteVisible=t}}},[t("div",{staticClass:"details"},[t("el-descriptions",{attrs:{title:"站点详情",direction:"vertical",column:4,border:""}},[t("el-descriptions-item",{attrs:{label:"站点编号"}},[e._v(e._s(e.detailForm.siteNumber))]),t("el-descriptions-item",{attrs:{label:"站点名称"}},[e._v(e._s(e.detailForm.siteName))]),t("el-descriptions-item",{attrs:{label:"所属区域",span:2}},[e._v(e._s(e.detailForm.name))]),t("el-descriptions-item",{attrs:{label:"备注"}},[t("el-tag",{attrs:{size:"small"}},[e._v("站点")])],1)],1)],1)]),t("el-dialog",{attrs:{title:"",visible:e.dialogThermodynamicVisible,width:"40%"},on:{"update:visible":function(t){e.dialogThermodynamicVisible=t}}},[t("div",{staticStyle:{width:"600px",height:"400px"},attrs:{id:"main"}})])],1)},Ze=[],He=a(8194),Qe={name:"CarInfoRecord",inject:["reload"],data(){return{store:W,app:{},options:null,chartDom:"",myChart:"",data:[[0,0,0],[1,0,0]],xData:["站点1","站点2","站点3","站点4","站点5"],yData:["36","36.2","36.4","36.6","36.8","37","37.2"],search:"",PageName:"车辆信息记录",startDate:"",endDate:"",date1:"",time1:"",date3:"",time3:"",pageNum:"1",pageSize:"10",totalCount:0,limit:10,currentPage:1,detailForm:{siteNumber:"",siteName:"",name:""},vehicleData:[],vehicleSearchData:[],getOrSearch:0,dialogSiteVisible:!1,dialogThermodynamicVisible:!1,dialogAddVehicleVisible:!1,searchForm:{currentPage:1,pageSize:10,obuId:"",licensePlate:"",siteName:"",startTime:"",endTime:""},showSiteForm:[],vehicleForm:{obuId:"",licensePlate:"",startTime:"",endTime:"",frequency:"",regionalName:"",siteId:"",devId:"",trackRecord:"",rawData:"",riskLevel:"",controlLevel:""}}},mounted(){this.updateVehicleData()},methods:{updateVehicleData(){E().then((e=>{this.vehicleData=e.data.rows,this.suiJi(this.vehicleData),this.totalCount=e.data.totalCount,this.store.vehicleData=e.data.rows,this.getOrSearch=0})).catch((e=>{console.log(e)}))},suiJi(e){e.map(((e,t)=>{let a=1.3*Math.random()+36,i=Math.round(10*a)/10;e["wendu"]=i}))},showThermodynamicDiagram(e){this.dialogThermodynamicVisible=!0,null===this.chartDom?this.initThermodynamicDom(e):this.$nextTick((()=>{console.log("2",this.chartDom),this.initThermodynamicDom(e)}))},initThermodynamicDom(e){this.chartDom=document.getElementById("main"),this.myChart=He.S1(this.chartDom);let t=[[0,0,0],[1,0,0]],a=1.3*Math.random()+36,i=Math.round(10*a)/10;t.map(((t,a)=>{if(0===a)switch(!0){case e<=36:t[2]=10*(e-36);break;case e<=36.2:t[1]=1,t[2]=10*(e-36);break;case e<=36.4:t[1]=2,t[2]=10*(e-36);break;case e<=36.6:t[1]=3,t[2]=10*(e-36);break;case e<=36.8:t[1]=4,t[2]=10*(e-36);break;case e<=37:t[1]=5,t[2]=10*(e-36);break;case e<=37.2:t[1]=6,t[2]=10*(e-36);break}else switch(!0){case i<=36:t[2]=10*(i-36);break;case i<=36.2:t[1]=1,t[2]=10*(i-36);break;case i<=36.4:t[1]=2,t[2]=10*(i-36);break;case i<=36.6:t[1]=3,t[2]=10*(i-36);break;case i<=36.8:t[1]=4,t[2]=10*(i-36);break;case i<=37:t[1]=5,t[2]=10*(i-36);break;case i<=37.2:t[1]=6,t[2]=10*(i-36);break}}));let l={title:{text:"司机温度热力图"},tooltip:{},grid:{height:"50%",top:"10%"},xAxis:{data:["入站口","出站口"]},yAxis:{type:"category",data:["36","36.2","36.4","36.6","36.8","37","37.2"],splitArea:{show:!0}},visualMap:{min:0,max:12,calculable:!0,orient:"horizontal",left:"center",bottom:"15%"},series:[{name:"温度",type:"heatmap",data:t}]};this.myChart.setOption(l)},addVehicle(){this.vehicleForm.startTime=this.date1,this.vehicleForm.endTime=this.date3,H(this.vehicleForm).then((e=>{console.log(e),this.reload()})).catch((e=>{console.log(e)})),this.dialogAddVehicleVisible=!1},currentChange(e){0===this.getOrSearch?(this.pageNum=e,Z(this.pageNum,this.pageSize).then((e=>{this.vehicleData=e.data.rows,this.suiJi(this.vehicleData)})).catch((e=>{console.log(e)}))):(this.searchForm.currentPage=e,this.getQuery())},sizeChange(e){0===this.getOrSearch?(this.pageSize=e,this.searchForm.pageSize=e,Z(this.pageNum,this.pageSize).then((e=>{this.vehicleData=e.data.rows,this.suiJi(this.vehicleData)})).catch((e=>{console.log(e)}))):(this.searchForm.pageSize=e,this.getQuery())},getQuery(){0===this.getOrSearch&&(this.currentPage=1),Q(this.searchForm).then((e=>{console.log(this.searchForm),this.vehicleSearchData=e.data.rows,this.suiJi(this.vehicleData),this.totalCount=e.data.totalCount,this.getOrSearch=1})).catch((e=>{console.log(e)}))},clearSearch(){this.updateVehicleData(),this.reload()},getSite(e){this.dialogSiteVisible=!0,console.log(e),console.log(typeof e),this.store.siteAllData.map(((t,a)=>{t.siteId===e&&(this.detailForm.siteNumber=t.siteNumber,this.detailForm.siteName=t.siteName,this.detailForm.name=t.name)}))},showSite(e,t,a){this.vehicleForm.riskLevel=t,this.vehicleForm.controlLevel=a,this.store.siteAllData.map((t=>{t.name===e&&this.showSiteForm.push(t)})),console.log(this.showSiteForm)}}},Ue=Qe,We=(0,m.Z)(Ue,Ee,Ze,!1,null,"057faedf",null),Ge=We.exports,Xe=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"button-line"},[t("div",{staticClass:"button"},[t("el-select",{staticClass:"ct-width",attrs:{clearable:"",filterable:"",placeholder:"请选择车辆"},model:{value:e.selectForm.obuId,callback:function(t){e.$set(e.selectForm,"obuId",t)},expression:"selectForm.obuId"}},e._l(this.obuIdList,(function(e,a){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1),t("el-date-picker",{staticClass:"input-style",staticStyle:{width:"210px"},attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:e.selectForm.start,callback:function(t){e.$set(e.selectForm,"start",t)},expression:"selectForm.start"}}),e._v(" - "),t("el-date-picker",{staticClass:"input-style",staticStyle:{width:"210px","margin-right":"10px"},attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:e.selectForm.end,callback:function(t){e.$set(e.selectForm,"end",t)},expression:"selectForm.end"}}),t("el-button",{staticClass:"add-margin",staticStyle:{height:"38px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.showVehicle}},[e._v("展示路径")])],1)]),t("div",{attrs:{id:"container"}}),t("div",{staticClass:"item"},[t("h4",[e._v("左击获取经纬度：")]),t("div",{staticClass:"input-item"},[t("input",{directives:[{name:"model",rawName:"v-model",value:this.store.gps,expression:"this.store.gps"}],attrs:{type:"text",readonly:"true"},domProps:{value:this.store.gps},on:{input:function(t){t.target.composing||e.$set(this.store,"gps",t.target.value)}}})])]),t("button",{on:{click:e.testFunc}},[e._v("ccc")])])},Ke=[],Ye={name:"siteMap",data(){return{store:W,gps:[],Marker:[],selectForm:{start:"",end:"",obuId:""},obuIdList:[],markerList:[],newSiteRange:[],polygonList:[],arr:[],i:0}},mounted(){this.initMap()},methods:{initMap(){se().load({key:"e0182f82d3a2e2470ca386ea85595acc",version:"2.0",plugins:["AMap.MarkerCluster","AMap.ElasticMarker","AMap.Driving","AMap.DragRoute","AMap.PolygonEditor","AMap.CircleEditor","AMap.ControlBar","AMap.MouseTool"]}).then((e=>{this.store.vehicleMap=new e.Map("container",{resizeEnable:!0,zoom:15,viewMode:"3D",center:[114.215448,22.684815]}),this.store.vehicleMap.on("click",(e=>{this.store.gps.splice(0),this.store.gps.push(e.lnglat.lng,e.lnglat.lat)})),this.store.getAllVehicleData(),this.removeTheSame(),this.addAllMarker(),this.createDefaultPolygon(),this.addAllPolygonToMap()})).catch((e=>{console.log(e)}))},testFunc(){},addAllMarker(){for(let e=0;e<this.store.siteAllData.length;e++)this.markerList[e]=new AMap.Marker({position:this.store.siteAllData[e].siteRange,offset:new AMap.Pixel(-13,-30),label:{direction:"right",offset:new AMap.Pixel(10,0),content:this.store.siteAllData[e].siteName}});this.addMarkerToMap()},addMarkerToMap(e){for(let t=0;t<this.markerList.length;t++)this.markerList[t].setMap(this.store.vehicleMap)},createDefaultPolygon(){this.store.regionAllData.map(((e,t)=>{switch(this.store.regionAllData[t].riskLevel){case"无风险":this.polygonList[t]=new AMap.Polygon({path:e.area,fillColor:"#7FFFD4",strokeOpacity:1,fillOpacity:.7,strokeColor:"#7FFFD4",strokeWeight:2,strokeStyle:"solid",strokeDasharray:[5,5]});break;case"低风险":this.polygonList[t]=new AMap.Polygon({path:e.area,fillColor:"#00BFFF",strokeOpacity:1,fillOpacity:.7,strokeColor:"#00BFFF",strokeWeight:2,strokeStyle:"solid",strokeDasharray:[5,5]});break;case"中风险":this.polygonList[t]=new AMap.Polygon({path:e.area,fillColor:"#FFD700",strokeOpacity:1,fillOpacity:.7,strokeColor:"#FFD700",strokeWeight:2,strokeStyle:"solid",strokeDasharray:[5,5]});break;case"高风险":this.polygonList[t]=new AMap.Polygon({path:e.area,fillColor:"#FF0000",strokeOpacity:1,fillOpacity:.7,strokeColor:"#FF0000",strokeWeight:2,strokeStyle:"solid",strokeDasharray:[5,5]});break;default:this.polygonList[t]=new AMap.Polygon({path:e.area,fillColor:"#7FFFD4",strokeOpacity:1,fillOpacity:.7,strokeColor:"#7FFFD4",strokeWeight:3,strokeStyle:"solid",strokeDasharray:[5,5]})}}))},addAllPolygonToMap(){this.store.vehicleMap.remove(this.polygonList),this.store.vehicleMap.add(this.polygonList)},showVehicle(){console.log(this.selectForm),U(this.selectForm).then((e=>{console.log(e.data),this.vehicleTrack(e.data)})).catch((e=>{}))},removeTheSame(){let e=[];this.store.vehicleAllData.map(((t,a)=>{""!=t.obuId&&e.push(t.obuId)}));for(let t=0;t<e.length;t++)-1===this.obuIdList.lastIndexOf(e[t])&&this.obuIdList.push(e[t]);console.log(this.obuIdList)},vehicleTrack(e){let t=new AMap.DragRoute(this.store.vehicleMap,e,AMap.DrivingPolicy.LEAST_FEE);t.search()}}},et=Ye,tt=(0,m.Z)(et,Xe,Ke,!1,null,"0dc62d71",null),at=tt.exports,it=function(){var e=this,t=e._self._c;return t("div",{staticClass:"beat-content"},[t("div",{staticClass:"beat-line"},[t("div",{staticClass:"beat-page"},[e._v(e._s(e.pageName))]),t("div",{staticClass:"beat-button"},[t("div",{staticClass:"beat-button-input"},[t("el-select",{staticClass:"adjustment",staticStyle:{width:"165px"},attrs:{clearable:"",placeholder:"请选择设备类型"},model:{value:e.searchForm.devId,callback:function(t){e.$set(e.searchForm,"devId",t)},expression:"searchForm.devId"}},e._l(this.store.deviceAllData,(function(a){return t("el-option",{key:a.id,attrs:{label:a.devName,value:a.devId},nativeOn:{click:function(t){return e.getQuery.apply(null,arguments)}}})})),1)],1)])]),t("div",{staticClass:"beat-list"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:0===e.getOrSearch?e.beatData:e.beatSearchData,height:"540"}},[t("el-table-column",{attrs:{align:"center",label:"设备ID","min-width":"100",prop:"devId"}}),t("el-table-column",{attrs:{align:"center",label:"设备名称","min-width":"200",prop:"devName",sortable:""}}),t("el-table-column",{attrs:{align:"center",label:"创建时间","min-width":"200",prop:"createTime"}}),t("el-table-column",{attrs:{align:"center",label:"心跳记录","min-width":"200",prop:"heartbeatRecord"}})],1),t("el-pagination",{staticStyle:{"text-align":"center"},attrs:{layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1)])},lt=[],rt={name:"DeviceBeatMana",data(){return{store:W,beatData:[],beatSearchData:[],getOrSearch:0,search:"",pageName:"设备心跳",pageNum:"1",pageSize:"10",totalCount:0,searchForm:{currentPage:1,pageSize:10,devId:""}}},created(){this.updateBeatData()},methods:{updateBeatData(){Re(this.pageNum,this.pageSize).then((e=>{this.beatData=e.data.rows,this.totalCount=e.data.totalCount,this.getOrSearch=0})).catch((e=>{console.log(e)}))},currentChange(e){0===this.getOrSearch?(this.pageNum=e,Re(this.pageNum,this.pageSize).then((e=>{console.log("res ",e.data),this.beatData=e.data.rows})).catch((e=>{console.log(e)}))):(this.searchForm.currentPage=e,Pe(this.searchForm).then((e=>{this.beatSearchData=e.data.rows,this.totalCount=e.data.totalCount,this.getOrSearch=1})).catch((e=>{console.log(e)})))},sizeChange(e){0===this.getOrSearch?(this.pageSize=e,Re(this.pageNum,this.pageSize).then((e=>{this.beatData=e.data.rows})).catch((e=>{console.log(e)}))):(this.searchForm.pageSize=e,Pe(this.searchForm).then((e=>{this.beatSearchData=e.data.rows,this.getOrSearch=1})).catch((e=>{console.log(e)})))},getQuery(){this.searchForm.devId=Number(this.searchForm.devId),console.log(typeof this.searchForm.devId),Pe(this.searchForm).then((e=>{console.log(e),this.beatSearchData=e.data.rows,this.totalCount=e.data.totalCount,this.getOrSearch=1})).catch((e=>{console.log(e)}))}}},st=rt,ot=(0,m.Z)(st,it,lt,!1,null,"3b437acb",null),nt=ot.exports,ct=function(){var e=this,t=e._self._c;return t("div",[t("div",{attrs:{id:"container"}}),t("div",{staticClass:"item"},[t("h4",[e._v("左击获取经纬度：")]),t("div",{staticClass:"input-item"},[t("input",{directives:[{name:"model",rawName:"v-model",value:this.store.gps,expression:"this.store.gps"}],attrs:{type:"text",readonly:"true"},domProps:{value:this.store.gps},on:{input:function(t){t.target.composing||e.$set(this.store,"gps",t.target.value)}}})])]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showDraw,expression:"showDraw"}],staticClass:"draw"},[t("div",{staticClass:"word"},[e._v("左键点击地图上需要创建站点的地方，然后点创建按钮")]),t("div",{staticClass:"button"},[t("el-row",[t("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.addMarker}},[e._v("创建")]),t("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){return e.clickToList(e.str1)}}},[e._v("确认位置")]),t("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.cancel}},[e._v("取消")])],1)],1)]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.changeDraw,expression:"changeDraw"}],staticClass:"change-site-draw"},[t("div",{staticClass:"word"},[e._v(" 点击开始修改，然后按住左键拖拽站点至目的地，然后点击完成修改 ")]),t("div",{},[t("el-row",[t("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.cancelChange}},[e._v("取消")]),t("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.dragSite}},[e._v("开始修改")]),t("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.endChange}},[e._v("完成修改")])],1)],1)])])},ht=[],dt={name:"siteMap",data(){return{store:W,gps:[],str1:"返回站点列表",Marker:[],markerList:[],newSiteRange:[],showDraw:!1,changeDraw:!1,siteId:"",arr:[],i:0}},mounted(){this.initMap()},methods:{initMap(){se().load({key:"e0182f82d3a2e2470ca386ea85595acc",version:"2.0",plugins:["AMap.MarkerCluster","AMap.ElasticMarker"]}).then((e=>{this.store.siteMap=new e.Map("container",{resizeEnable:!0,zoom:15,viewMode:"3D",center:[114.215448,22.684815]}),this.store.siteMap.on("click",(e=>{this.store.gps.splice(0),this.store.gps.push(e.lnglat.lng,e.lnglat.lat)})),"添加站点"===this.$route.query.order&&(this.showDraw=!0),this.$route.query.siteId>=0&&(this.searchSite(this.$route.query.siteId),this.siteId=this.$route.query.siteId,this.changeDraw=!0,this.changedMarker(this.$route.query.siteId,this.arr)),this.addAllMarker()})).catch((e=>{console.log(e)}))},addMarker(){this.store.Marker=new AMap.Marker({icon:"//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png",position:this.store.gps,offset:new AMap.Pixel(-13,-30)}),this.store.Marker.setMap(this.store.siteMap)},clickToList(e){this.showDraw=!1,this.$router.push({name:"SiteMana",params:{order:e}})},cancel(){this.showDraw=!1,this.$router.push("/SiteMana")},changedMarker(e,t){this.Marker=new AMap.Marker({icon:"//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png",position:t,offset:new AMap.Pixel(-13,-30)}),this.newSiteRange=t,this.Marker.setMap(this.store.siteMap),this.store.siteMap.setCenter(t)},dragSite(){this.Marker.setDraggable(!0),this.Marker.on("dragend",(e=>{this.newSiteRange.splice(0),this.newSiteRange.push(e.lnglat.lng,e.lnglat.lat)}))},endChange(){this.Marker.setDraggable(!1),this.changeDraw=!1,this.store.siteData[this.i].siteRange=this.newSiteRange,this.$router.push({name:"SiteMana",params:{siteID:this.siteId}})},searchSite(e){let t=Number(e);console.log(this.store.siteAllData);for(let a=0;a<this.store.siteAllData.length;a++)console.log(this.store.siteAllData[a].siteId),t===this.store.siteAllData[a].siteId&&(this.arr=this.store.siteAllData[a].siteRange,this.i=a)},cancelChange(){this.changeDraw=!1,this.$router.push("/SiteMana")},addAllMarker(){for(let e=0;e<this.store.siteAllData.length;e++)this.markerList[e]=new AMap.Marker({position:this.store.siteAllData[e].siteRange,offset:new AMap.Pixel(-13,-30),label:{direction:"right",offset:new AMap.Pixel(10,0),content:this.store.siteAllData[e].siteName}});this.addMarkerToMap()},addMarkerToMap(e){for(let t=0;t<this.markerList.length;t++)this.markerList[t].setMap(this.store.siteMap)}}},mt=dt,ut=(0,m.Z)(mt,ct,ht,!1,null,"3de6e6a6",null),pt=ut.exports;i["default"].use(ee.ZP);const gt=[{path:"/",component:me},{path:"/RegMana",component:De,children:[{path:"/",component:me},{path:"/RegMana/Map",component:me},{path:"/RegMana/RegManaList",component:fe}]},{path:"/SiteMana",name:"SiteMana",component:xe},{path:"/siteMap",component:pt},{path:"/DeviceMana",component:Ie},{path:"/DeviceTypeMana",component:Je},{path:"/CarInfoRecord",component:Ge},{path:"/vehicleMap",component:at},{path:"/DeviceBeatMana",component:nt}],vt=new ee.ZP({mode:"hash",base:"",routes:gt});var bt=vt,ft=a(3322);ft.Z.key="e0182f82d3a2e2470ca386ea85595acc",i["default"].use(r()),window._AMapSecurityConfig={securityJsCode:"c4ede32087e61f139613441cf05b5460"},i["default"].config.productionTip=!1,new i["default"]({router:bt,render:e=>e(Y)}).$mount("#app")},4654:function(){}},t={};function a(i){var l=t[i];if(void 0!==l)return l.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,a),r.exports}a.m=e,function(){var e=[];a.O=function(t,i,l,r){if(!i){var s=1/0;for(h=0;h<e.length;h++){i=e[h][0],l=e[h][1],r=e[h][2];for(var o=!0,n=0;n<i.length;n++)(!1&r||s>=r)&&Object.keys(a.O).every((function(e){return a.O[e](i[n])}))?i.splice(n--,1):(o=!1,r<s&&(s=r));if(o){e.splice(h--,1);var c=l();void 0!==c&&(t=c)}}return t}r=r||0;for(var h=e.length;h>0&&e[h-1][2]>r;h--)e[h]=e[h-1];e[h]=[i,l,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,i){var l,r,s=i[0],o=i[1],n=i[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(l in o)a.o(o,l)&&(a.m[l]=o[l]);if(n)var h=n(a)}for(t&&t(i);c<s.length;c++)r=s[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(h)},i=self["webpackChunketc_pf"]=self["webpackChunketc_pf"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=a.O(void 0,[998],(function(){return a(9969)}));i=a.O(i)})();
//# sourceMappingURL=app.e53577ff.js.map